<Window x:Class="PromptComposer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PromptComposer"
        mc:Ignorable="d"
        Title="AI Prompt 生成器 (WPF)" Height="720" Width="1100"
        WindowStartupLocation="CenterScreen">
    <Grid Background="#0f1115">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="425*" MaxWidth="425" />
            <ColumnDefinition Width="304*" MaxWidth="400" />
            <ColumnDefinition Width="371*" MaxWidth="400"/>
        </Grid.ColumnDefinitions>

        <!-- 左侧：自定义对象与选项 -->
        <Border Margin="10,10,10,10" Padding="16" CornerRadius="14" Background="#181b12" BorderBrush="#2a2f3a" BorderThickness="1">
            <!--DockPanel LastChildFill="True"  VerticalAlignment="Center" Margin="-7,0,-7,0" RenderTransformOrigin="0.5,0.5"-->
            <Grid Margin="0,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="74*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" MinHeight="116.2"/>
                    <RowDefinition Height="Auto" MinHeight="60"/>
                    <RowDefinition Height="Auto" MinHeight="198.5"/>
                    <RowDefinition Height="Auto" MinHeight="282.48"/>

                </Grid.RowDefinitions>

                <GroupBox Grid.Row="0"  Header="新增对象（例如：镜头）" Foreground="#c9d1d9" BorderBrush="#2a2f3a" Background="#181b22" Margin="0,0,0,10" >
                    <StackPanel Orientation="Vertical" >
                        <!-- 选择/切换方案 -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" >
                            <TextBlock Text="当前方案：" VerticalAlignment="Center"/>
                            <ComboBox x:Name="CmbSets"
                      Width="220"
                      ItemsSource="{Binding CategorySets}"
                      SelectedItem="{Binding SelectedSet, Mode=TwoWay}"
                      DisplayMemberPath="Name"/>
                        </StackPanel>

                        <Separator/>

                        <!-- 新增方案 -->
                        <StackPanel Orientation="Horizontal" >
                            <TextBox x:Name="TxtNewSetName" Width="220" />
                            <Button Content="新增方案"
                    Width="100"
                    Click="BtnAddSet_Click"/>
                        </StackPanel>

                        <!-- 重命名当前方案 -->
                        <StackPanel Orientation="Horizontal" >
                            <TextBox x:Name="TxtRenameSetName" Width="220" />
                            <Button Content="重命名"
                    Width="100"
                    Click="BtnRenameSet_Click"/>
                        </StackPanel>

                        <!-- 删除当前方案 -->
                        <Button Content="删除当前方案"
                Width="140"
                HorizontalAlignment="Left"
                Click="BtnRemoveSet_Click"/>
                    </StackPanel>
                </GroupBox>


                <!-- 新增对象（例如：镜头/风格/光照/主体等） -->
                <GroupBox Header="新增对象（例如：镜头）" Foreground="#c9d1d9" BorderBrush="#2a2f3a" Background="#181b22" Margin="0,0,0,0" Grid.Row="1" >
                    <StackPanel Orientation="Horizontal" Margin="0">
                        <TextBox x:Name="TxtNewCategory" Width="220" Height="34" Padding="8,4" 
                                     Background="#0f1115" Foreground="#e6edf3" BorderBrush="#2a2f3a" BorderThickness="1"
                                     ToolTip="输入对象名称，例如：镜头、风格、光照、主体..." />
                        <Button Content="添加对象" Margin="8,0,0,0" Width="110" Height="34" Click="BtnAddCategory_Click"/>
                    </StackPanel>
                </GroupBox>



                <!-- 对象列表（固定高度 + 滚动） -->
                <GroupBox   Grid.Row="2" Grid.Column="0" Header="对象列表（选择后可添加其选项）" Foreground="#c9d1d9" BorderBrush="#2a2f3a" Background="#181b22" Margin="0,0,0,0" Grid.RowSpan="1" >
                    <Grid Margin="8,0,8,0" >
                        <Grid.RowDefinitions>
                            <!-- 固定高度的列表区域 -->
                            <RowDefinition Height="119*"  />
                            <!-- 底部按钮条 -->
                            <RowDefinition Height="142*" />
                        </Grid.RowDefinitions>

                        <!-- 列表：固定高度 + 可滚动 -->

                        <ScrollViewer  Grid.Row="0" VerticalScrollBarVisibility="Auto" Margin="0,0,0,0">
                            <ListBox x:Name="LstCategories"
                             ItemsSource="{Binding Categories}"
                             DisplayMemberPath="Name"
                             SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"
                             Background="Transparent" Foreground="#e6edf3" BorderThickness="0" Height="139"/>
                        </ScrollViewer>


                        <!-- 按钮固定在下面，不随列表滚动 -->
                        <StackPanel Orientation="Horizontal"  RenderTransformOrigin="0.5,0.5" Grid.Row="1" Margin="0,0,0,0">
                            <Button Content="删除对象" Width="90" Height="28" Margin="0,0,8,0" Click="BtnRemoveCategory_Click"/>
                            <Button Content="上移" Width="70" Height="28" Margin="0,0,8,0" Click="BtnMoveCategoryUp_Click"/>
                            <Button Content="下移" Width="70" Height="28" Click="BtnMoveCategoryDown_Click"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>

                <!-- 为所选对象添加选项（右侧），选项列表同样固定高度 + 滚动 -->
                <GroupBox Grid.Row="3" Grid.Column="0" Header="为选中对象添加选项" Foreground="#c9d1d9" BorderBrush="#2a2f3a" Background="#181b22" Margin="0,0,0,0" >
                    <Grid Margin="0,0,0,0" Height="Auto">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"  />
                            <!-- 标题 + 添加输入行 -->
                            <RowDefinition Height="Auto"  />
                            <RowDefinition Height="Auto"  />
                            <!-- 固定高度的选项列表区域 -->
                            <!-- 底部按钮行 -->
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"  />
                            <ColumnDefinition Width="Auto"  />
                        </Grid.ColumnDefinitions>


                        <TextBlock Grid.Column="0" Grid.Row="0" Text="{Binding SelectedCategoryDisplay}" Foreground="#9fb0ff" Margin="10,10,10,10"/>
                        <!-- 标题 + 添加输入 -->

                        <StackPanel Grid.Column="1" Grid.Row="0"  Margin="0,0,0,0">
                            <TextBox x:Name="TxtNewOption" Width="Auto" Height="Auto" Padding="2,2"
                             Background="#0f1115" Foreground="#e6edf3" BorderBrush="#2a2f3a" BorderThickness="6"
                             ToolTip="输入选项名称，例如：固定镜头 / 俯视镜头 / 正面镜头..." />
                            <Button Content="添加选项" Margin="0,0,0,0" Width="80" Height="20" Click="BtnAddOption_Click"/>
                        </StackPanel>

                        <!-- 固定高度 + 可滚动的选项列表 -->
                        <Border Background="#0f1115" BorderBrush="#2a2f3a" BorderThickness="1" CornerRadius="6" Margin="0,0,0,0" Grid.Row="1" Grid.ColumnSpan="2">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <ListBox x:Name="LstOptionsOfSelected"
                             ItemsSource="{Binding SelectedCategory.Options}"
                             DisplayMemberPath="Name"
                             Background="Transparent" Foreground="#e6edf3" BorderThickness="0"/>
                            </ScrollViewer>
                        </Border>

                        <!-- 底部按钮行（不随列表滚动） -->
                        <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,0" HorizontalAlignment="Center" Width="339">
                            <Button Content="删除选项" Width="90" Height="28" Margin="0,0,8,0" Click="BtnRemoveOption_Click"/>
                            <Button Content="上移" Width="70" Height="28" Margin="0,0,8,0" Click="BtnMoveOptionUp_Click"/>
                            <Button Content="下移" Width="70" Height="28" Click="BtnMoveOptionDown_Click"/>
                        </StackPanel>
                    </Grid>
                </GroupBox>



            </Grid>
            <!--/DockPanel-->
        </Border>




        <Border Grid.Column="1" Margin="10,10,10,10" Padding="16" CornerRadius="14" Background="#181b22" BorderBrush="#2a2f3a" BorderThickness="1">
            <!-- 使用区：下拉选择组合 -->
            <GroupBox Grid.Row="0" Header="使用区：选择各对象的选项" Foreground="#c9d1d9" BorderBrush="#2a2f3a" Background="#181b22"  Margin="0,10,0,13">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Height="562" RenderTransformOrigin="0.5,0.5" Margin="0,0,11,0">
                    <ScrollViewer.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform ScaleY="1"/>
                            <SkewTransform/>
                            <RotateTransform/>
                            <TranslateTransform/>
                        </TransformGroup>
                    </ScrollViewer.RenderTransform>
                    <ItemsControl ItemsSource="{Binding Categories}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="12,8">
                                    <TextBlock Text="{Binding Name}" Width="50" VerticalAlignment="Center" Foreground="#e6edf3"/>
                                    <ComboBox ItemsSource="{Binding Options}"
                                  SelectedItem="{Binding SelectedOption, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                  DisplayMemberPath="Name"
                                  Width="150" Height="25"
                                  Background="Bisque" Foreground="Green" BorderBrush="Navy"/>
                                    <Button Content="清空" Margin="8,0,0,0" Height="28" Width="60"
                                CommandParameter="{Binding}"
                                Click="BtnClearOneSelection_Click"/>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </GroupBox>
        </Border>

        <!-- 右侧：输出区 -->
        <Border Grid.Column="2" Margin="10,10,10,10" Padding="16" CornerRadius="14" Background="#181b12" BorderBrush="#2a2f3a" BorderThickness="1">
            <!--DockPanel  LastChildFill="True" Height="647" VerticalAlignment="Center" Margin="-7,0,-7,0" RenderTransformOrigin="0.5,0.5"-->


            <GroupBox Grid.Row="0"  Header="rwer" Foreground="#c9d1d9" BorderBrush="#2a2f3a" Background="#181b22" Margin="0,0,0,10" RenderTransformOrigin="0.48,0.117"    >

                <Grid Height="599"  >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="100" MinHeight="1"   />
                        <RowDefinition Height="227" MinHeight="227"  />
                        <RowDefinition Height="1" MinHeight="100"  />
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row ="0" Orientation="Vertical" Margin="0,16,0,5"   >
                        <TextBlock Text="分隔符：" Foreground="#9aa4b2" Margin="0,0,6,0" Height="15"/>
                        <TextBox x:Name="TxtSeparator" Width="140" Height="32" Padding="8,4"
                             Background="#0f1115" Foreground="#e6edf3" BorderBrush="#2a2f3a" BorderThickness="1"
                             ToolTip="用于拼接各选项的分隔符，默认：, " Text=", " />
                        <CheckBox x:Name="ChkIncludeCategoryLabel" Content="包含对象名称标签" Margin="12,0,0,0" Foreground="#c9d1d9" IsChecked="False"
                              ToolTip="选中后输出将包含对象名，例如：镜头: 俯视镜头" Height="20" />
                    </StackPanel>


                    <StackPanel  Grid.Row ="1" RenderTransformOrigin="0.518,0.066"   >

                        <TextBox x:Name="TxtOutput"
                         AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                         Background="#0f1115" Foreground="#e6edf3" BorderBrush="#2a2f3a" BorderThickness="1"
                         FontFamily="Consolas" FontSize="14"  Height="211" Width="367" />
                    </StackPanel>

                    <StackPanel  Grid.Row ="2" HorizontalAlignment="Center" Width="401" Margin="0,37,0,-57">
                        <Button Content="清空选择" Width="100" Height="32" Margin="0,0,8,0" Click="BtnClearSelections_Click"/>
                        <Button Content="生成" Width="120" Height="32" Margin="0,0,8,0" Click="BtnGenerate_Click"/>
                        <Button Content="复制到剪贴板" Width="130" Height="32" Click="BtnCopy_Click"/>
                    </StackPanel>


                </Grid>
            </GroupBox>
            <!--/DockPanel-->
        </Border>
    </Grid>
</Window>
